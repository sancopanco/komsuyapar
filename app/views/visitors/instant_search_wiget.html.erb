
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tourism search by Algolia</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/bootstrap/3.3.5/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css" />
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/instantsearch.js/1/instantsearch.min.css" />
  
  <style type="text/css">
  /* VARIABLES
// ------------------------- */
/* GENERAL
// ------------------------- */
body {
  font-family: Roboto;
  font-size: 16px;
  color: #565A5C; }

.aisdemo--left-column {
  height: 400px; }

.aisdemo--right-column {
  padding-right: 0;
  padding-left: 0; }

/* HEADER
// ------------------------- */
.aisdemo-navbar {
  margin: 0;
  padding: 0;
  border-bottom: 1px solid #DCE0E0;
  position: relative; }
  .aisdemo-navbar .is-logo {
    display: inline-block;
    position: relative;
    top: -8px;
    left: 16px; }
  .aisdemo-navbar .logo {
    display: inline-block;
    padding: 14px 22px;
    font-size: 40px;
    line-height: 1;
    font-family: Courier;
    color: #FF585B;
    border-right: 1px solid #DCE0E0; }
  .aisdemo-navbar .fa-search {
    font-size: 30px;
    position: absolute;
    top: 17px;
    left: 140px;
    color: #DCE0E0; }
  .aisdemo-navbar #q {
    position: absolute;
    top: 15px;
    left: 180px;
    width: 50%;
    border: 0;
    box-shadow: none; }
    .aisdemo-navbar #q:focus {
      outline: none;
      box-shadow: none; }

/* FILTERS
// ------------------------- */
.aisdemo-filters .aisdemo-filter {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 15px;
  padding-bottom: 15px;
  border-bottom: 1px solid #DCE0E0; }
.aisdemo-filters .aisdemo-filter-title {
  font-size: 1em;
  font-weight: normal;
  padding-top: 9px;
  padding-left: 30px; }
.aisdemo-filters .date, .aisdemo-filters #guests select {
  font-size: .8em;
  padding: 8px 10px;
  border: 1px solid #DCE0E0; }
.aisdemo-filters #guests select {
  width: 100%;
  padding-right: 20px;
  border-radius: 0;
  background: transparent;
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
  .aisdemo-filters #guests select:focus {
    outline: none; }
.aisdemo-filters .guests-caret:before {
  line-height: 1;
  position: absolute;
  top: 0;
  right: 20px;
  width: 2em;
  padding-top: .8em;
  content: '\25bc';
  text-align: center;
  pointer-events: none;
  color: #82888A; }
.aisdemo-filters #room_types .ais-refinement-list--count {
  display: none; }
.aisdemo-filters #room_types .ais-refinement-list--item {
  display: inline-block;
  cursor: pointer; }
  .aisdemo-filters #room_types .ais-refinement-list--item label {
    font-size: .8em;
    font-weight: normal;
    box-sizing: border-box;
    width: 100%;
    padding: 9px 10px 7px;
    background: #EDEFED; }
.aisdemo-filters #room_types .ais-refinement-list--checkbox {
  position: relative;
  bottom: 3px;
  float: right;
  width: 1.25em;
  height: 1.25em;
  margin-left: 20px;
  vertical-align: top;
  border: 1px solid #DCE0E0;
  background: #FFFFFF;
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
  .aisdemo-filters #room_types .ais-refinement-list--checkbox:focus {
    outline: none; }
.aisdemo-filters #room_types .ais-refinement-list--item__active .ais-refinement-list--checkbox:before {
  font-size: .85em;
  position: absolute;
  width: 1.25em;
  content: '\2713';
  text-align: center;
  color: #FF5A5F; }
.aisdemo-filters #price .ais-range-slider--target {
  margin: 30px 9px 18px; }
.aisdemo-filters #price .ais-range-slider--handle {
  border-color: #FF585B; }
.aisdemo-filters #price .ais-range-slider--handle-lower {
  -webkit-transform: translateX(-50%);
          transform: translateX(-50%); }
.aisdemo-filters #price .ais-range-slider--handle-upper {
  -webkit-transform: translateX(50%);
          transform: translateX(50%); }
.aisdemo-filters #price .ais-range-slider--tooltip:last-child {
  right: 0; }
.aisdemo-filters #price .ais-range-slider--connect {
  background-color: #FF585B; }

/* STATS
// ------------------------- */
#stats {
  font-size: 1em;
  font-weight: normal;
  position: absolute;
  bottom: 0;
  padding: 5px 15px; }

/* MAP
// ------------------------- */
#map {
  height: 400px; }

/* RESULTS
// ------------------------- */
#results {
  padding: 40px 20px;
  background: #EDEFED; }

#hits .hit .pictures-wrapper {
  position: relative; }
  #hits .hit .pictures-wrapper .picture {
    width: 100%; }
  #hits .hit .pictures-wrapper .profile {
    position: absolute;
    bottom: -16px;
    right: 12px;
    width: 60px;
    border: 4px solid rgba(255, 255, 255, 0.3);
    border-radius: 30px; }
#hits .hit .infos {
  height: 90px;
  padding: 16px 20px; }
  #hits .hit .infos h4 {
    font-size: 1em;
    font-weight: normal; }
  #hits .hit .infos p {
    font-size: .8em;
    color: #949697; }
  #hits .hit .infos em {
    font-style: normal;
    color: #FF585B; }

/* PAGINATION
// ------------------------- */
#pagination {
  text-align: center; }
  #pagination .ais-pagination--item {
    display: inline-block;
    margin: 1px; }
  #pagination .ais-pagination--link {
    color: #FF585B;
    border-radius: 4px;
    background: transparent; }
  #pagination .pagination > .active > a {
    color: #FFFFFF;
    border-color: #FF585B;
    background: #FF585B; }
  #pagination .pagination > li > a:focus, #pagination .pagination > li > a:hover, #pagination .pagination > li > span:focus, #pagination .pagination > li > span:hover {
    color: #FFFFFF;
    border-color: #FF585B;
    background: #FF585B; }

.thank-you {
  text-align: center;
  font-size: .8em; }
  .thank-you a {
    color: #FF585B; 
  }

 
  </style>
  <!--[if lte IE 9]>
  <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>
  <![endif]-->
</head>
<body>

  <!-- Header -->
  <div class="container-fluid" style="padding-left: 0; padding-right: 0;">
    <header class="navbar navbar-static-top aisdemo-navbar">
      <a href="./" class="logo">A</a>
      <i class="fa fa-search"></i>
      <input type="text" class="form-control" id="q" />
    </header>
  </div>
  <!-- /Header -->

  <!-- Filters and map -->
  <div class="container-fluid">
    <div class="row">

      <!-- Left col -->
      <div class="col-sm-7 aisdemo--left-column">

        <div class="aisdemo-filters">
          <!-- Dates & Guests -->
          <div class="row aisdemo-filter">
            <div class="col-sm-2 aisdemo-filter-title">Dates</div>
            <div class="col-sm-3"><div class="date">10/30/3015</div></div>
            <div class="col-sm-3"><div class="date">11/30/3015</div></div>
            <div class="col-sm-3"><div id="guests"></div></div>
          </div>
          <!-- Room types -->
          <div class="row aisdemo-filter">
            <div class="col-sm-2 aisdemo-filter-title">Room Type</div>
            <div id="room_types"></div>
          </div>
          <!-- Price -->
          <div class="row aisdemo-filter">
            <div class="col-sm-2 aisdemo-filter-title">Price Range</div>
            <div class="col-sm-9" id="price"></div>
          </div>
        </div>

        <div class="row">
          <div id="stats"></div>
        </div>

      </div>
      <!-- /Left col -->

      <!-- Right col -->
      <div class="col-sm-5 aisdemo--right-column">
        <div id="map"></div>
      </div>
      <!-- /Right col -->

    </div>
  </div>
  <!-- /Filters and Map -->

  <!-- Results -->
  <div class="container-fluid" id="results">
    <div class="row">
      <div id="hits"></div>
    </div>
    <div class="row">
      <div id="pagination"></div>
      <div class="thank-you">Data courtesy of <a href="https://www.airbnb.com/">airbnb.com</a></div>
    </div>
  </div>
  <!-- /Results -->

  <script src="https://maps.googleapis.com/maps/api/js"></script>
  
  <script src="https://cdn.jsdelivr.net/instantsearch.js/1/instantsearch.min.js"></script>
  <script src="https://cdn.jsdelivr.net/instantsearch-googlemaps/1/instantsearch-googlemaps.min.js"></script>
<script>

 
/* global instantsearch */

var APPLICATION_ID = '<%= ENV['ALGOLIASEARCH_APPLICATION_ID'] %>'
var SEARCH_ONLY_API_KEY = '<%= ENV['ALGOLIASEARCH_API_KEY_SEARCH'] %>'
var INDEX_NAME = '<%= User.index_name %>'

var search = instantsearch({
  appId: APPLICATION_ID,
  apiKey: SEARCH_ONLY_API_KEY ,
  indexName: INDEX_NAME
});

search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#q',
    placeholder: 'Where are you going?'
  })
);

search.addWidget(
  instantsearch.widgets.stats({
    container: '#stats'
  })
);

var hitTemplate =
  '<div class="hit col-sm-3">' +
  '<div class="pictures-wrapper">' +
    '<img class="picture" src="{{picture_url}}" />' +
    '<img class="profile" src="{{user.user.thumbnail_url}}" />' +
  '</div>' +
  '<div class="infos">' +
  '<h4 class="media-heading">{{{_highlightResult.name.value}}}</h4>' +
  '<p>{{room_type}} - {{{_highlightResult.city.value}}}, {{{_highlightResult.country.value}}}</p>' +
  '</div>' +
  '</div>';

var noResultsTemplate = '<div class="text-center">No results found matching <strong>{{query}}</strong>.</div>';

search.addWidget(
  instantsearch.widgets.hits({
    container: '#hits',
    hitsPerPage: 12,
    templates: {
      empty: noResultsTemplate,
      item: hitTemplate
    }
  })
);

search.addWidget(
  instantsearch.widgets.pagination({
    container: '#pagination',
    scrollTo: '#results',
    cssClasses: {
      root: 'pagination',
      active: 'active'
    }
  })
);

search.addWidget(
  instantsearch.widgets.refinementList({
    container: '#room_types',
    attributeName: 'room_type',
    operator: 'or',
    cssClasses: {item: ['col-sm-3']},
    limit: 10
  })
);

search.addWidget(
  instantsearch.widgets.rangeSlider({
    container: '#price',
    attributeName: 'price',
    pips: false,
    tooltips: {format: function(formattedValue, rawValue) {return '$' + parseInt(formattedValue)}}
  })
  );

search.addWidget(
  instantsearch.widgets.googleMaps({
    container: document.querySelector('#map')
  })
);

search.addWidget(
  instantsearch.widgets.numericSelector({
    container: '#guests',
    attributeName: 'person_capacity',
    operator: '>=',
    options: [
      { label: '1 guest', value: 1},
      { label: '2 guests', value: 2},
      { label: '3 guests', value: 3},
      { label: '4 guests', value: 4},
      { label: '5 guests', value: 5},
      { label: '6 guests', value: 6}
    ]
  })
);

search.start();
    



  </script>
</body>
</html>